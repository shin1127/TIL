# 再帰関数に関するあれこれ

## 再帰関数って何？

ある関数 F の中に、自身と同じ関数 F を組み込んだもの。
以下のsum(n) は、1からnまでの自然数の和を返す。

```Python
def sum(n):
    if n <= 0:
        return n
    return n + sum(n-1)
    
````


## 再帰関数の何がうれしいの？

複雑な処理を簡単に書ける。  
コード量を抑えることができる。

## 再帰関数の悪いところは？

他の手段と比べて極端に処理速度が遅くなるケースがある。
後述のフィボナッチ数列に関するアルゴリズム問題のように。


## 具体例

再帰関数を使ったJSの例と、使わなかったPythonの例。  

【問題】  
フィボナッチ数列のうち、 各桁の数字を足した数で割り切れる数を、 以下の例に続けて小さい 方から5個求めてください。  
例） 
2 　 → 　 2 ÷ 2  
3 　 → 　 3 ÷ 3  
5 　 → 　 5 ÷ 5  
8 　 → 　 8 ÷ 8  
21 　 → 　 21 ÷ 3 　… 2 ＋ 1 ＝ 3 で 割る  
144 　 → 　 144 ÷ 9 　… 1 ＋ 4 ＋ 4 ＝ 9 で 割る  

出典『増井敏克. プログラマ脳を鍛える数学パズル シンプルで高速なコードが書けるようになる70問 』 


```JavaScript

function Q(num) {
  function fib(num) {
    if(num <= 1) return 1;
    return fib(num - 1) + fib(num - 2);
  }

  function calcSum(fibVal) {
    if(fibVal === '') return 0;
    return Number(fibVal.toString()[0]) + calcSum(fibVal.toString().substring(1));
  }

  let answers = [];
  const START_POINT = 5; // The place of return fibs where you want to start from
  for (let i = START_POINT; answers.length < 5; i++) {
    let fibVal = fib(i);
    let sum = calcSum(fibVal);
    if(fibVal%sum === 0) answers.push(fibVal);
  }

  return answers;
}

```


```Python

fbn_list = [1,1]  # 初期のリストを用意する
max_results = 10  # 獲得したい正解の個数

correct_count = 0  # 割り切れた数字の個数を宣言

while True:
    
    divisor = 0  # 割る数を初期化
    
    # 新たなフィボナッチ数の取得
    fbn = fbn_list[-1] + fbn_list[-2]
    
    # STR型としてFBNを取得
    str_fbn = str(fbn)

    # 桁数の総和を取得
    for i in range(len(str_fbn)):
        divisor += int(str_fbn[i])
        
    
    # 割り切れた数字を表示
    if fbn % divisor == 0:
        print(fbn)
        correct_count += 1
        if correct_count == max_results:
            break

    # 新しく取得していたフィボナッチ数をリストに追加する

    fbn_list.append(fbn)
    
    ```
